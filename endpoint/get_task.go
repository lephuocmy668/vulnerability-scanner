// This file contains the implementation of the endpoint for getting task details
package endpoint

import (
	"context"

	"github.com/go-kit/kit/endpoint"
	domain "github.com/lephuocmy668/vulnerability-scanner/domain"
)

// GetTaskDetailRequest is representing the request parameters
type GetTaskDetailRequest struct {
	ID string
}

// getTaskDetailResponse is representing the response data
type getTaskDetailResponse struct {
	Task *domain.ScanningTask `json:"task,omitempty"`
	Err  error                `json:"error,omitempty"`
}

// error is a method that returns the error associated with the response
func (r getTaskDetailResponse) error() error { return r.Err }

// MakeGetTaskDetailEndpoint returns an endpoint for getting task detail
func MakeGetTaskDetailEndpoint(ts domain.ScannerService) endpoint.Endpoint {
	return func(ctx context.Context, request interface{}) (interface{}, error) {
		req := request.(GetTaskDetailRequest)
		task, err := ts.GetTaskDetail(req.ID)
		return getTaskDetailResponse{Task: task, Err: err}, err
	}
}
