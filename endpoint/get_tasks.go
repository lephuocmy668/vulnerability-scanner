// This file contains the implementation of the endpoint for getting list task
package endpoint

import (
	"context"

	"github.com/go-kit/kit/endpoint"
	domain "github.com/lephuocmy668/vulnerability-scanner/domain"
)

// getTasksResponse is a response model that holds an array of ScanningTask
// objects and an error.
type getTasksResponse struct {
	Tasks []domain.ScanningTask `json:"tasks,omitempty"`
	Err   error                 `json:"error,omitempty"`
}

// error extracts the error from the response.
func (r getTasksResponse) error() error { return r.Err }

// MakeGetTasksEndpoint returns an endpoint for getting list task
func MakeGetTasksEndpoint(ts domain.ScannerService) endpoint.Endpoint {
	return func(ctx context.Context, request interface{}) (interface{}, error) {
		req := request.(domain.GetTasksRequest)
		tasks, err := ts.GetTasks(req)
		return getTasksResponse{Tasks: tasks, Err: err}, err
	}
}
