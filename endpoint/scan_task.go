package endpoint

import (
	"context"

	"github.com/go-kit/kit/endpoint"
	domain "github.com/lephuocmy668/vulnerability-scanner/domain"
)

// MakeScanEndpoint is an endpoint function that starts a scanning task by its ID
// and returns the status of the scanning process
func MakeScanEndpoint(svc domain.ScannerService) endpoint.Endpoint {
	return func(ctx context.Context, request interface{}) (interface{}, error) {
		result, err := svc.Scan(request.(string), ctx)
		if err != nil {
			return "", nil
		}
		return result.Status, nil
	}
}
