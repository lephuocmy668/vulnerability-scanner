package nats

import (
	"github.com/lephuocmy668/vulnerability-scanner/domain"
	natsio "github.com/nats-io/nats.go"
)

// natsSvc implements domain.Publisher interface using NATS message broker
type natsSvc struct {
	nc *natsio.Conn
}

// NewPublisher creates a new instance of natsSvc using provided NATS connection
func NewPublisher(nc *natsio.Conn) domain.Publisher {
	return &natsSvc{nc}
}

// Publish publishes message to a NATS queue
func (n *natsSvc) Publish(queue string, message string) error {

	return n.nc.Publish(queue, []byte(message))
}
